<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØµÙ„Ø§ØªÙŠ - Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ•Œ</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <style>
        /* ========== Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ========== */
        :root {
            --primary-color: #2a9d8f;
            --primary-dark: #264653;
            --secondary-color: #e76f51;
            --accent-color: #f4a261;
            --background-color-light: #F8FAFC;
            --card-color-light: #FFFFFF;
            --text-color-light: #0F172A;
            --light-text-light: #64748B;
            --border-color-light: #E2E8F0;
            --background-color-dark: #0F172A;
            --card-color-dark: #1E293B;
            --text-color-dark: #F8FAFC;
            --light-text-dark: #94A3B8;
            --border-color-dark: #334155;

            --background-color: var(--background-color-light);
            --card-color: var(--card-color-light);
            --text-color: var(--text-color-light);
            --light-text: var(--light-text-light);
            --border-color: var(--border-color-light);
            
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --radius: 16px;
            --transition: all 0.3s ease;
            --gradient: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
        }

        body.dark-mode {
            --background-color: var(--background-color-dark);
            --card-color: var(--card-color-dark);
            --text-color: var(--text-color-dark);
            --light-text: var(--light-text-dark);
            --border-color: var(--border-color-dark);
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Tajawal', sans-serif; }

        body { 
            background-color: var(--background-color); 
            color: var(--text-color); 
            line-height: 1.6; 
            padding: 20px; 
            min-height: 100vh; 
            transition: background-color 0.3s, color 0.2s;
        }
        
        body::before { 
            content: ''; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100vh; 
            background-color: var(--transition-bg, transparent); 
            z-index: 9999; 
            clip-path: circle(0% at var(--clip-x, 50%) var(--clip-y, 50%)); 
            transition: clip-path 0.6s cubic-bezier(0.65, 0, 0.35, 1); 
            pointer-events: none; 
        }
        body.transition-active::before { 
            clip-path: circle(150% at var(--clip-x, 50%) var(--clip-y, 50%)); 
        }

        .container { max-width: 1200px; margin: 0 auto; }

        /* ===== Ø§Ù„Ù‡ÙŠØ¯Ø± ===== */
        header { 
            text-align: center; 
            margin-bottom: 40px; 
            padding: 30px; 
            background: var(--gradient); 
            border-radius: var(--radius); 
            box-shadow: var(--shadow); 
            position: relative; 
            overflow: hidden; 
            color: white; 
        }
        header::before { 
            content: ""; 
            position: absolute; 
            top: -50%; 
            left: -50%; 
            width: 200%; 
            height: 200%; 
            background: rgba(255, 255, 255, 0.1); 
            transform: rotate(25deg); 
        }
        .header-top { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            position: relative; 
            z-index: 2; 
            margin-bottom: 20px; 
        }
        .header-controls { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
        }

        .theme-switcher, .lang-switcher { 
            display: flex; 
            align-items: center; 
            justify-content: space-around; 
            background-color: rgba(0, 0, 0, 0.25); 
            padding: 5px 15px; 
            border-radius: 50px; 
            cursor: pointer; 
            position: relative; 
            height: 40px; 
            color: white;
            gap: 8px;
        }
        .theme-switcher { width: 70px; }
        .lang-switcher { 
            width: 60px; 
            justify-content: center; 
            font-weight: bold; 
            font-size: 1rem; 
        }
        
        .theme-switcher-handle { 
            position: absolute; 
            width: 30px; 
            height: 30px; 
            background-color: var(--secondary-color); 
            border-radius: 50%; 
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); 
            top: 5px; 
        }
        html[dir="rtl"] .theme-switcher-handle { right: 5px; }
        html[dir="ltr"] .theme-switcher-handle { left: 5px; }
        
        html[dir="rtl"] body.dark-mode .theme-switcher-handle { transform: translateX(-30px); }
        html[dir="ltr"] body.dark-mode .theme-switcher-handle { transform: translateX(30px); }
        
        .theme-switcher i { 
            width: 30px; 
            height: 30px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            z-index: 1; 
            transition: transform 0.3s ease, color 0.3s ease; 
        }
        body:not(.dark-mode) .fa-sun { color: #fff; transform: scale(1.1) rotate(360deg); }
        body.dark-mode .fa-moon { color: #fff; transform: scale(1.1) rotate(360deg); }
        
        h1 { 
            margin-bottom: 10px; 
            font-size: 2.5rem; 
            position: relative; 
            font-weight: 800; 
        }
        .subtitle { 
            font-size: 1.2rem; 
            opacity: 0.9; 
            font-weight: 300; 
        }

        /* ===== Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ ===== */
        .main-nav { 
            display: flex; 
            justify-content: center; 
            background-color: rgba(0,0,0,0.2); 
            border-radius: 50px; 
            padding: 5px; 
            margin-top: 20px; 
            position: relative; 
            z-index: 2; 
            flex-wrap: wrap; 
            gap: 5px;
        }
        .nav-tab { 
            background-color: transparent; 
            border: none; 
            color: white; 
            padding: 10px 25px; 
            border-radius: 50px; 
            cursor: pointer; 
            transition: var(--transition); 
            font-weight: bold; 
            font-size: 1rem; 
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        .nav-tab.active { 
            background-color: var(--secondary-color); 
        }

        /* ===== Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø·Ø· ===== */
        .plans-section {
            background-color: var(--card-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .plans-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .plans-header h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .new-plan-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .new-plan-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
        
        .plans-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .plan-card {
            background: var(--background-color);
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            padding: 20px;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }
        
        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }
        
        .plan-card.active {
            border-color: var(--primary-color);
            background-color: rgba(42, 157, 143, 0.05);
        }
        
        .plan-card.completed {
            border-color: var(--accent-color);
        }
        
        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-left: 40px;
        }
        
        .plan-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .plan-badge {
            background: var(--secondary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 50px;
            font-size: 0.8rem;
        }
        
        .plan-dates {
            color: var(--light-text);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .plan-progress {
            margin: 15px 0;
        }
        
        .plan-progress-bar {
            height: 10px;
            background: var(--border-color);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .plan-progress-fill {
            height: 100%;
            background: var(--primary-color);
            transition: width 0.5s;
        }
        
        .plan-stats {
            display: flex;
            justify-content: space-between;
            color: var(--light-text);
            font-size: 0.9rem;
        }
        
        .plan-actions {
            position: absolute;
            top: 15px;
            left: 15px;
            display: flex;
            gap: 10px;
        }
        
        .plan-action-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            opacity: 0;
        }
        
        .plan-card:hover .plan-action-btn {
            opacity: 1;
        }
        
        .plan-action-btn.edit {
            background: var(--primary-color);
        }
        
        .plan-action-btn.delete {
            background: var(--secondary-color);
        }
        
        .plan-action-btn:hover {
            transform: scale(1.1);
        }
        
        .plan-action-btn.edit:hover {
            background: #1e7b6f;
        }
        
        .plan-action-btn.delete:hover {
            background: #d64f2a;
        }

        /* ===== Ù†Ø§ÙØ°Ø© Ø¥Ù†Ø´Ø§Ø¡/ØªØ¹Ø¯ÙŠÙ„ Ø®Ø·Ø© ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--card-color);
            border-radius: var(--radius);
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
        }
        
        .modal-content h2 {
            color: var(--primary-color);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-color);
            font-weight: 500;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border-radius: 50px;
            border: 1px solid var(--border-color);
            background: var(--background-color);
            color: var(--text-color);
            font-size: 1rem;
        }
        
        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 50px;
            transition: var(--transition);
        }
        
        .radio-option:hover {
            border-color: var(--primary-color);
        }
        
        .radio-option input[type="radio"] {
            width: auto;
            margin: 0;
        }
        
        .custom-plan {
            margin-top: 20px;
            padding: 20px;
            background: var(--background-color);
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .modal-btn.primary {
            background: var(--gradient);
            color: white;
        }
        
        .modal-btn.secondary {
            background: var(--background-color);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .modal-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        /* ===== ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ===== */
        .plan-detail-section {
            background-color: var(--card-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .plan-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .plan-detail-header h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .plan-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-card {
            background: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 15px;
            text-align: center;
        }
        
        .info-label {
            color: var(--light-text);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .info-value.surplus {
            color: var(--accent-color);
        }
        
        .pages-progress {
            margin-bottom: 30px;
        }
        
        .pages-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--light-text);
        }
        
        .pages-bar {
            height: 20px;
            background: var(--border-color);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .pages-fill {
            height: 100%;
            background: var(--primary-color);
            transition: width 0.5s;
        }

        /* ===== Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ===== */
        .reading-section {
            background-color: var(--card-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .reading-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .reading-header h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .day-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .day-nav-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--gradient);
            color: white;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .day-nav-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }
        
        .day-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .current-day {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-color);
            min-width: 150px;
            text-align: center;
        }
        
        .reading-card {
            background: var(--background-color);
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            padding: 30px;
            text-align: center;
            max-width: 500px;
            margin: 0 auto;
            transition: var(--transition);
        }
        
        .reading-card.completed {
            border-color: var(--primary-color);
            background-color: rgba(42, 157, 143, 0.05);
        }
        
        .quran-icon {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .day-target {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: var(--light-text);
        }
        
        .target-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            display: block;
        }
        
        .reading-status {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .status-btn {
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            background: var(--background-color);
            color: var(--text-color);
            border: 2px solid var(--border-color);
        }
        
        .status-btn.read {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .status-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }
        
        .pages-input {
            margin: 20px 0;
        }
        
        .pages-input label {
            display: block;
            margin-bottom: 10px;
            color: var(--light-text);
        }
        
        .pages-input input {
            width: 120px;
            padding: 12px;
            border-radius: 50px;
            border: 1px solid var(--border-color);
            background: var(--background-color);
            color: var(--text-color);
            text-align: center;
            font-size: 1.2rem;
            margin: 0 auto;
            display: block;
        }
        
        .save-reading-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            max-width: 300px;
            margin-top: 20px;
        }
        
        .save-reading-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }
        
        .save-reading-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ===== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø®Ø·Ø© ===== */
        .plan-stats-section {
            background-color: var(--card-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .plan-stats-section h2 {
            color: var(--primary-color);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .stat-item {
            text-align: center;
            padding: 20px;
            background: var(--background-color);
            border-radius: var(--radius);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .stat-label {
            color: var(--light-text);
            font-size: 0.95rem;
        }

        /* ===== Ø¹Ù†Ø§ØµØ± Ù…Ø³Ø§Ø¹Ø¯Ø© ===== */
        .notification { 
            position: fixed; 
            top: 30px; 
            right: 30px; 
            background: var(--gradient); 
            color: white; 
            padding: 15px 25px; 
            border-radius: var(--radius); 
            box-shadow: var(--shadow); 
            transform: translateX(150%); 
            transition: transform 0.4s ease; 
            z-index: 3000; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            max-width: 400px; 
        }
        .notification.show { 
            transform: translateX(0); 
        }

        #back-to-top-btn { 
            position: fixed; 
            bottom: 30px; 
            right: 30px; 
            width: 50px; 
            height: 50px; 
            background: var(--primary-color); 
            color: white; 
            border: none; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.2rem; 
            cursor: pointer; 
            box-shadow: var(--shadow); 
            opacity: 0; 
            visibility: hidden; 
            transform: translateY(20px); 
            transition: all 0.3s ease; 
            z-index: 1500; 
        }
        #back-to-top-btn.show { 
            opacity: 1; 
            visibility: visible; 
            transform: translateY(0); 
        }

        .no-plan-msg {
            text-align: center;
            padding: 60px 20px;
            color: var(--light-text);
        }
        
        .no-plan-msg i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--border-color);
        }

        @media (max-width: 768px) { 
            .header-top { flex-wrap: wrap; gap: 20px; justify-content: center; }
            h1 { font-size: 1.8rem; }
            .plans-header { flex-direction: column; }
            .reading-header { flex-direction: column; }
            .day-selector { width: 100%; justify-content: center; }
            .radio-group { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div class="header-controls">
                    <div class="theme-switcher" id="theme-switcher" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø±">
                        <div class="theme-switcher-handle"></div>
                        <i class="fas fa-sun"></i>
                        <i class="fas fa-moon"></i>
                    </div>
                    <div class="lang-switcher" id="lang-switcher" title="ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©">
                        <span id="lang-toggle">EN</span>
                    </div>
                </div>
                <div style="flex-grow: 1;"></div>
             <h1>
    <i class="fas fa-mosque"></i>
    <span data-key="appTitle">ØµÙ„Ø§ØªÙŠ</span>
    <span class="title-separator"> | </span>
    <span data-key="pageTitle">Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†</span>
</h1>

                <div style="flex-grow: 1;"></div>
                <div class="header-controls" style="visibility: hidden;">
                    <div class="theme-switcher"></div>
                    <div class="lang-switcher"></div>
                </div>
            </div>
            
            <p class="subtitle" data-key="subtitle">Ø®Ø·Ø· Ù„Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… Ø¨Ø§Ù„ØµÙØ­Ø§Øª ÙˆØªØ§Ø¨Ø¹ ØªÙ‚Ø¯Ù…Ùƒ</p>

            <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
         <div class="main-nav">
    <a href="index.html" class="nav-tab" data-key="navHome">
        <i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    </a>

    <a href="Taktem.html" class="nav-tab active" data-key="navQuranKhatm">
        <i class="fas fa-book-quran"></i> Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†
    </a>

                                    <a href="quran.html" class="nav-tab " data-key="navMushaf"><i class="fas fa-book-open"></i> Ø§Ù„Ù…ØµØ­Ù Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</a>

    <a href="azkar_ramadan.html" class="nav-tab" data-key="navRamadanDuas">
        <i class="fas fa-moon"></i> Ø£Ø¯Ø¹ÙŠØ© Ø±Ù…Ø¶Ø§Ù†
    </a>

    <a href="traweh.html" class="nav-tab" data-key="navTaraweeh">
        <i class="fas fa-mosque"></i> Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­
    </a>

    <a href="sadakate.html" class="nav-tab" data-key="navSadaqati">
        <i class="fas fa-hand-holding-heart"></i> ØµØ¯Ù‚Ø§ØªÙŠ
    </a>
     <a href="mosabaka.html" class="nav-tab " data-key="navQuestions"><i class="fas fa-question-circle"></i> Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø±Ù…Ø¶Ø§Ù†ÙŠØ©</a>
                <a href="ahades.html" class="nav-tab" data-key="navHadith"><i class="fas fa-book-open"></i> Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«</a>

    <a href="lessons.html" class="nav-tab" data-key="navVideos">
        <i class="fas fa-video"></i> Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø¯ÙŠÙ†ÙŠØ©
    </a>
  <a href="about.html" class="nav-tab" data-key="aboutSite">
    Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹
</a>

</div>

        </header>

        <main>
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø·Ø· -->
            <div class="plans-section">
                <div class="plans-header">
                    <h2><i class="fas fa-list"></i> <span data-key="myPlans">Ø®Ø·Ø·ÙŠ Ù„Ù„Ø®ØªÙ…</span></h2>
                    <button class="new-plan-btn" onclick="openNewPlanModal()">
                        <i class="fas fa-plus"></i> <span data-key="newPlan">Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
                    </button>
                </div>
                <div id="plans-grid" class="plans-grid"></div>
            </div>

            <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© -->
            <div id="plan-detail-container" style="display: none;">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
        </main>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ù†Ø´Ø§Ø¡/ØªØ¹Ø¯ÙŠÙ„ Ø®Ø·Ø© -->
    <div class="modal-overlay" id="plan-modal">
        <div class="modal-content">
            <h2 id="modal-title"><i class="fas fa-plus-circle"></i> <span data-key="newPlanTitle">Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©</span></h2>
            
            <input type="hidden" id="editing-plan-id">
            
            <div class="form-group">
                <label data-key="planName">Ø§Ø³Ù… Ø§Ù„Ø®Ø·Ø©</label>
                <input type="text" id="plan-name" placeholder="Ù…Ø«Ø§Ù„: Ø®ØªÙ…Ø© Ø±Ù…Ø¶Ø§Ù†">
            </div>
            
            <div class="form-group">
                <label data-key="planType">Ù…Ø¯Ø© Ø§Ù„Ø®Ø·Ø©</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="plan-type" value="7" checked> <span data-key="oneWeek">Ø£Ø³Ø¨ÙˆØ¹ (7 Ø£ÙŠØ§Ù…)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="plan-type" value="10"> <span data-key="tenDays">10 Ø£ÙŠØ§Ù…</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="plan-type" value="14"> <span data-key="twoWeeks">Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† (14 ÙŠÙˆÙ…)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="plan-type" value="21"> <span data-key="threeWeeks">3 Ø£Ø³Ø§Ø¨ÙŠØ¹ (21 ÙŠÙˆÙ…)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="plan-type" value="30"> <span data-key="oneMonth">Ø´Ù‡Ø± (30 ÙŠÙˆÙ…)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="plan-type" value="custom"> <span data-key="custom">Ù…Ø®ØµØµ</span>
                    </label>
                </div>
            </div>
            
            <div class="custom-plan" id="custom-plan-inputs" style="display: none;">
                <div class="form-group">
                    <label data-key="customDays">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</label>
                    <input type="number" id="custom-days" min="1" max="365" value="30">
                </div>
            </div>
            
            <div class="form-group">
                <label data-key="totalPages">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª</label>
                <input type="number" id="total-pages" value="604" min="1" max="604">
                <small style="color: var(--light-text);">(Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… 604 ØµÙØ­Ø©)</small>
            </div>
            
            <div class="form-group">
                <label data-key="startDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</label>
                <input type="date" id="start-date">
            </div>
            
            <div class="modal-actions">
                <button class="modal-btn primary" onclick="savePlan()"><span data-key="save">Ø­ÙØ¸</span></button>
                <button class="modal-btn secondary" onclick="closePlanModal()"><span data-key="cancel">Ø¥Ù„ØºØ§Ø¡</span></button>
            </div>
        </div>
    </div>

    <button id="back-to-top-btn" title="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰"><i class="fas fa-arrow-up"></i></button>
    <div class="notification" id="notification"></div>

    <script>
        (function() {
            // --- Ø¹Ù†Ø§ØµØ± DOM ---
            const themeSwitcher = document.getElementById('theme-switcher');
            const langSwitcher = document.getElementById('lang-switcher');
            const notification = document.getElementById('notification');
            const backToTopBtn = document.getElementById('back-to-top-btn');
            const plansGrid = document.getElementById('plans-grid');
            const planDetailContainer = document.getElementById('plan-detail-container');
            
            // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ø§ÙØ°Ø©
            const planModal = document.getElementById('plan-modal');
            const modalTitle = document.getElementById('modal-title');
            const editingPlanId = document.getElementById('editing-plan-id');
            const planNameInput = document.getElementById('plan-name');
            const planTypeRadios = document.querySelectorAll('input[name="plan-type"]');
            const customPlanDiv = document.getElementById('custom-plan-inputs');
            const customDaysInput = document.getElementById('custom-days');
            const totalPagesInput = document.getElementById('total-pages');
            const startDateInput = document.getElementById('start-date');

            // --- Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª ---
            const translations = {
                ar: {
                    pageTitle: "Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†",
                      navHome: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
                          appTitle: "ØµÙ„Ø§ØªÙŠ",

    navQuranKhatm: "Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†",
    navRamadanDuas: "Ø£Ø¯Ø¹ÙŠØ© Ø±Ù…Ø¶Ø§Ù†",
    navTaraweeh: "Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­",
    navSadaqati: "ØµØ¯Ù‚Ø§ØªÙŠ",
    navVideos: "Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ø¯ÙŠÙ†ÙŠØ©",
    aboutSite:  "Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹",
                                                   navMushaf: "Ø§Ù„Ù…ØµØ­Ù Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ",


                    subtitle: "Ø®Ø·Ø· Ù„Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… Ø¨Ø§Ù„ØµÙØ­Ø§Øª ÙˆØªØ§Ø¨Ø¹ ØªÙ‚Ø¯Ù…Ùƒ",
                    navHome: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
                    navQuran: "Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†",
                    navDuas: "Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©",
                    navTaraweeh: "Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­",
                    myPlans: "Ø®Ø·Ø·ÙŠ Ù„Ù„Ø®ØªÙ…",
                    newPlan: "Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©",
                    newPlanTitle: "Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©",
                    editPlanTitle: "ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø®Ø·Ø©",
                    planName: "Ø§Ø³Ù… Ø§Ù„Ø®Ø·Ø©",
                    planType: "Ù…Ø¯Ø© Ø§Ù„Ø®Ø·Ø©",
                    oneWeek: "Ø£Ø³Ø¨ÙˆØ¹ (7 Ø£ÙŠØ§Ù…)",
                    tenDays: "10 Ø£ÙŠØ§Ù…",
                    twoWeeks: "Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† (14 ÙŠÙˆÙ…)",
                    threeWeeks: "3 Ø£Ø³Ø§Ø¨ÙŠØ¹ (21 ÙŠÙˆÙ…)",
                    oneMonth: "Ø´Ù‡Ø± (30 ÙŠÙˆÙ…)",
                    custom: "Ù…Ø®ØµØµ",
                    customDays: "Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…",
                    totalPages: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª",
                    startDate: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡",
                    create: "Ø¥Ù†Ø´Ø§Ø¡",
                    save: "Ø­ÙØ¸",
                    cancel: "Ø¥Ù„ØºØ§Ø¡",
                    planDetails: "ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø©",
                    days: "Ø£ÙŠØ§Ù…",
                    pagesRead: "ØµÙØ­Ø§Øª Ù…Ù‚Ø±ÙˆØ¡Ø©",
                    remaining: "Ù…ØªØ¨Ù‚ÙŠ",
                    surplus: "ÙØ§Ø¦Ø¶",
                    dailyTarget: "Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ",
                    completed: "Ù…ÙƒØªÙ…Ù„",
                    inProgress: "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",
                    notStarted: "Ù„Ù… ÙŠØ¨Ø¯Ø£",
                    read: "Ù‚Ø±Ø£Øª",
                    notRead: "Ù„Ù… Ø£Ù‚Ø±Ø£",
                    saved: "ØªÙ… Ø§Ù„Ø­ÙØ¸",
                    planCreated: "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø·Ø©",
                    planUpdated: "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø·Ø©",
                    planDeleted: "ØªÙ… Ø­Ø°Ù Ø§Ù„Ø®Ø·Ø©",
                    selectPlan: "Ø§Ø®ØªØ± Ø®Ø·Ø© Ù„Ù„Ø¨Ø¯Ø¡",
                    totalRead: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡",
                    average: "Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„ÙŠÙˆÙ…ÙŠ",
                    bestDay: "Ø£ÙØ¶Ù„ ÙŠÙˆÙ…",
                    completionRate: "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²",
                    daysCompleted: "Ø£ÙŠØ§Ù… Ù…ÙƒØªÙ…Ù„Ø©",
                    daysMissed: "Ø£ÙŠØ§Ù… ÙØ§Ø¦ØªØ©",
                    page: "ØµÙØ­Ø©",
                    pages: "ØµÙØ­Ø§Øª",
                    edit: "ØªØ¹Ø¯ÙŠÙ„",
                      navQuestions: "Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø±Ù…Ø¶Ø§Ù†ÙŠØ©",
                                                            navHadith: "Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«",
                    delete: "Ø­Ø°Ù"
                },
                en: {
                    pageTitle: "Quran Completion",
                      navHome: "Home",
    navQuranKhatm: "Quran Khatm",
    navRamadanDuas: "Ramadan Duas",
    navTaraweeh: "Taraweeh",
    navSadaqati: "My Charity",
    navVideos: "Islamic Lessons",
        appTitle: "My Salah",
aboutSite:  "About the Website" ,
  navQuestions: "Ramadan Questions",
                      navMushaf: "Interactive Mushaf",

                                                            navHadith: "Hadith Library",


                    subtitle: "Plan to complete the Quran by pages and track your progress",
                    navHome: "Home",
                    navQuran: "Quran Completion",
                    navDuas: "Duas",
                    navTaraweeh: "Taraweeh",
                    myPlans: "My Plans",
                    newPlan: "New Plan",
                    newPlanTitle: "Create New Plan",
                    editPlanTitle: "Edit Plan",
                    planName: "Plan Name",
                    planType: "Plan Duration",
                    oneWeek: "One Week (7 days)",
                    tenDays: "10 Days",
                    twoWeeks: "Two Weeks (14 days)",
                    threeWeeks: "Three Weeks (21 days)",
                    oneMonth: "One Month (30 days)",
                    custom: "Custom",
                    customDays: "Number of Days",
                    totalPages: "Total Pages",
                    startDate: "Start Date",
                    create: "Create",
                    save: "Save",
                    cancel: "Cancel",
                    planDetails: "Plan Details",
                    days: "Days",
                    pagesRead: "Pages Read",
                    remaining: "Remaining",
                    surplus: "Surplus",
                    dailyTarget: "Daily Target",
                    completed: "Completed",
                    inProgress: "In Progress",
                    notStarted: "Not Started",
                    read: "Read",
                    notRead: "Not Read",
                    saved: "Saved",
                    planCreated: "Plan created",
                    planUpdated: "Plan updated",
                    planDeleted: "Plan deleted",
                    selectPlan: "Select a plan to start",
                    totalRead: "Total Read",
                    average: "Daily Average",
                    bestDay: "Best Day",
                    completionRate: "Completion Rate",
                    daysCompleted: "Days Completed",
                    daysMissed: "Days Missed",
                    page: "Page",
                    pages: "Pages",
                    edit: "Edit",
                    delete: "Delete"
                }
            };

            // --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·Ø· ---
            let quranPlans = JSON.parse(localStorage.getItem('quranPlans_v4')) || [];
            let currentPlanId = localStorage.getItem('currentPlanId_v4') || null;

            // --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ® ---
           function getLocalToday() {
    const now = new Date();
    return new Date(now.getFullYear(), now.getMonth(), now.getDate());
}

const today = getLocalToday();

            
            // ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ù„Ù‰ Ø§Ù„ÙŠÙˆÙ…
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            startDateInput.value = `${year}-${month}-${day}`;

            // --- Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù†Ø§ÙØ°Ø© ---
            planTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    customPlanDiv.style.display = this.value === 'custom' ? 'block' : 'none';
                });
            });

            // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø«ÙŠÙ… ÙˆØ§Ù„Ù„ØºØ© ---
            function setupTheme() {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') {
                    document.body.classList.add('dark-mode');
                }
            }

            function toggleTheme() {
                if (document.body.classList.contains('transition-active')) return;
                
                const root = document.documentElement;
                const isDarkMode = document.body.classList.contains('dark-mode');
                const rect = themeSwitcher.getBoundingClientRect();
                const x = rect.left + rect.width / 2;
                const y = rect.top + rect.height / 2;
                
                root.style.setProperty('--clip-x', `${x}px`);
                root.style.setProperty('--clip-y', `${y}px`);
                root.style.setProperty('--transition-bg', isDarkMode ? 'var(--background-color-light)' : 'var(--background-color-dark)');
                
                document.body.classList.add('transition-active');
                
                setTimeout(() => {
                    document.body.classList.toggle('dark-mode');
                    localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
                }, 300);
                
                setTimeout(() => document.body.classList.remove('transition-active'), 600);
            }

            function toggleLanguage() {
    currentLang = currentLang === 'ar' ? 'en' : 'ar';

    // ØªÙˆØ­ÙŠØ¯ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ù…Ø¹ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹
    localStorage.setItem('language', currentLang);

    document.documentElement.lang = currentLang;
    document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
    
    document.getElementById('lang-toggle').textContent = currentLang === 'ar' ? 'EN' : 'Ø¹Ø±Ø¨ÙŠ';
    
    // ØªØ±Ø¬Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±
    document.querySelectorAll('[data-key]').forEach(el => {
        const key = el.getAttribute('data-key');
        if (translations[currentLang][key]) {
            el.textContent = translations[currentLang][key];
        }
    });
    
    renderPlans();
    if (currentPlanId) {
        renderPlanDetails(currentPlanId);
    }
}

// Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù„ØºØ© Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø¨Ø§Ù‚ÙŠ ØµÙØ­Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
let currentLang = localStorage.getItem('language') || 'ar';

            function showNotification(message) {
                notification.innerHTML = `<i class="fas fa-check-circle"></i> <div>${message}</div>`;
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 3000);
            }

            // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø§ÙØ°Ø© ---
            window.openNewPlanModal = function() {
                modalTitle.innerHTML = `<i class="fas fa-plus-circle"></i> ${translations[currentLang].newPlanTitle}`;
                editingPlanId.value = '';
                planNameInput.value = '';
                document.querySelector('input[name="plan-type"][value="7"]').checked = true;
                customPlanDiv.style.display = 'none';
                totalPagesInput.value = 604;
                startDateInput.value = `${year}-${month}-${day}`;
                planModal.classList.add('active');
            };

            window.openEditPlanModal = function(planId, event) {
                event.stopPropagation();
                
                const plan = quranPlans.find(p => p.id === planId);
                if (!plan) return;
                
                modalTitle.innerHTML = `<i class="fas fa-edit"></i> ${translations[currentLang].editPlanTitle}`;
                editingPlanId.value = planId;
                planNameInput.value = plan.name;
                
                // ØªØ­Ø¯ÙŠØ¯ Ù…Ø¯Ø© Ø§Ù„Ø®Ø·Ø©
                const days = plan.totalDays;
                let typeFound = false;
                [7, 10, 14, 21, 30].forEach(val => {
                    if (days === val) {
                        document.querySelector(`input[name="plan-type"][value="${val}"]`).checked = true;
                        typeFound = true;
                    }
                });
                
                if (!typeFound) {
                    document.querySelector('input[name="plan-type"][value="custom"]').checked = true;
                    customPlanDiv.style.display = 'block';
                    customDaysInput.value = days;
                } else {
                    customPlanDiv.style.display = 'none';
                }
                
                totalPagesInput.value = plan.totalPages;
                
                // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡
                const startDate = new Date(plan.startDate);
                const startYear = startDate.getFullYear();
                const startMonth = String(startDate.getMonth() + 1).padStart(2, '0');
                const startDay = String(startDate.getDate()).padStart(2, '0');
                startDateInput.value = `${startYear}-${startMonth}-${startDay}`;
                
                planModal.classList.add('active');
            };

            window.closePlanModal = function() {
                planModal.classList.remove('active');
            };

            // --- Ø­Ø³Ø§Ø¨ Ø§Ù„ØµÙØ­Ø§Øª ÙÙŠ Ø§Ù„ÙŠÙˆÙ… (Ø¹Ø¯Ø¯ ØµØ­ÙŠØ­) ---
            function calculatePagesPerDay(totalPages, totalDays) {
                return Math.ceil(totalPages / totalDays);
            }

            // --- Ø­ÙØ¸ Ø§Ù„Ø®Ø·Ø© (Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ ØªØ¹Ø¯ÙŠÙ„) ---
            window.savePlan = function() {
                const name = planNameInput.value.trim();
                if (!name) {
                    alert(currentLang === 'ar' ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø®Ø·Ø©' : 'Please enter a plan name');
                    return;
                }

                // Ù…Ø¯Ø© Ø§Ù„Ø®Ø·Ø©
                const type = document.querySelector('input[name="plan-type"]:checked').value;
                let totalDays;
                
                if (type === 'custom') {
                    totalDays = parseInt(customDaysInput.value) || 30;
                } else {
                    totalDays = parseInt(type);
                }

                const totalPages = parseInt(totalPagesInput.value) || 604;
                const pagesPerDay = calculatePagesPerDay(totalPages, totalDays);

                const startDate = new Date(startDateInput.value);
                startDate.setHours(0, 0, 0, 0);
                
                // Ø­Ø³Ø§Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡
                const endDate = new Date(startDate);
                endDate.setDate(endDate.getDate() + totalDays - 1);

                const planData = {
                    name: name,
                    startDate: startDate.toISOString(),
                    endDate: endDate.toISOString(),
                    totalDays: totalDays,
                    totalPages: totalPages,
                    pagesPerDay: pagesPerDay
                };

                const editingId = editingPlanId.value;
                
                if (editingId) {
                    // ØªØ¹Ø¯ÙŠÙ„ Ø®Ø·Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©
                    const planIndex = quranPlans.findIndex(p => p.id === editingId);
                    if (planIndex !== -1) {
                        // Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
                        const currentProgress = quranPlans[planIndex].progress;
                        
                        quranPlans[planIndex] = {
                            ...quranPlans[planIndex],
                            ...planData,
                            progress: currentProgress
                        };
                        
                        localStorage.setItem('quranPlans_v4', JSON.stringify(quranPlans));
                        showNotification(translations[currentLang].planUpdated);
                    }
                } else {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    const newPlan = {
                        id: Date.now().toString(),
                        ...planData,
                        progress: {}
                    };

                    quranPlans.push(newPlan);
                    localStorage.setItem('quranPlans_v4', JSON.stringify(quranPlans));
                    
                    currentPlanId = newPlan.id;
                    localStorage.setItem('currentPlanId_v4', currentPlanId);
                    
                    showNotification(translations[currentLang].planCreated);
                }
                
                renderPlans();
                if (currentPlanId) {
                    renderPlanDetails(currentPlanId);
                }
                closePlanModal();
            };

            // --- Ø­Ø°Ù Ø®Ø·Ø© ---
            window.deletePlan = function(planId, event) {
                event.stopPropagation();
                
                if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©ØŸ' : 'Are you sure you want to delete this plan?')) {
                    quranPlans = quranPlans.filter(p => p.id !== planId);
                    localStorage.setItem('quranPlans_v4', JSON.stringify(quranPlans));
                    
                    if (currentPlanId === planId) {
                        currentPlanId = quranPlans.length > 0 ? quranPlans[0].id : null;
                        localStorage.setItem('currentPlanId_v4', currentPlanId);
                        
                        if (currentPlanId) {
                            renderPlanDetails(currentPlanId);
                        } else {
                            planDetailContainer.style.display = 'none';
                        }
                    }
                    
                    renderPlans();
                    showNotification(translations[currentLang].planDeleted);
                }
            };

            // --- Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø·Ø· ---
            function renderPlans() {
                plansGrid.innerHTML = '';
                
                if (quranPlans.length === 0) {
                    plansGrid.innerHTML = `
                        <div class="no-plan-msg">
                            <i class="fas fa-quran"></i>
                            <p>${translations[currentLang].selectPlan}</p>
                        </div>
                    `;
                    return;
                }

                quranPlans.sort((a, b) => new Date(b.startDate) - new Date(a.startDate));

                quranPlans.forEach(plan => {
                    const stats = calculatePlanStats(plan);
                    const isActive = plan.id === currentPlanId;
                    
                    const card = document.createElement('div');
                    card.className = `plan-card ${isActive ? 'active' : ''} ${stats.completed ? 'completed' : ''}`;
                    card.onclick = () => selectPlan(plan.id);
                    
                    const startDate = new Date(plan.startDate);
                    const endDate = new Date(plan.endDate);
                    
                    card.innerHTML = `
                        <div class="plan-actions">
                            <button class="plan-action-btn edit" onclick="openEditPlanModal('${plan.id}', event)" title="${translations[currentLang].edit}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="plan-action-btn delete" onclick="deletePlan('${plan.id}', event)" title="${translations[currentLang].delete}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="plan-header">
                            <span class="plan-name">${plan.name}</span>
                            <span class="plan-badge">${stats.completed ? 'âœ…' : 'ğŸ“–'}</span>
                        </div>
                        <div class="plan-dates">
                            ${formatDate(startDate)} - ${formatDate(endDate)}
                        </div>
                        <div class="plan-progress">
                            <div class="plan-progress-bar">
                                <div class="plan-progress-fill" style="width: ${stats.percentage}%"></div>
                            </div>
                            <div class="plan-stats">
                                <span>${stats.pagesRead} / ${plan.totalPages} ${currentLang === 'ar' ? 'ØµÙØ­Ø©' : 'pages'}</span>
                                <span>${stats.percentage}%</span>
                            </div>
                        </div>
                    `;
                    
                    plansGrid.appendChild(card);
                });
            }

                        // --- Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø®Ø·Ø© ---
            function calculatePlanStats(plan) {
                let totalPagesRead = 0;
                let daysRead = 0;
                let maxPages = 0;
                let bestDay = null;
                let lastReadPage = 0; // Ù…ØªØºÙŠØ± Ù„ØªØªØ¨Ø¹ Ø¢Ø®Ø± ØµÙØ­Ø© ØªÙ…Øª Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§
                
                // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„ØªÙŠ ØªÙ…Øª Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ù„Ø­Ø³Ø§Ø¨ Ø¢Ø®Ø± ØµÙØ­Ø©
                const readDays = [];
                
                Object.entries(plan.progress).forEach(([date, day]) => {
                    if (day.pages > 0) {
                        totalPagesRead += day.pages;
                        daysRead++;
                        readDays.push({ date, pages: day.pages });
                        if (day.pages > maxPages) {
                            maxPages = day.pages;
                            bestDay = date;
                        }
                    }
                });
                
                // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£ÙŠØ§Ù… ØªØµØ§Ø¹Ø¯ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
                readDays.sort((a, b) => new Date(a.date) - new Date(b.date));
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Ø­ÙŠØ« ØªÙˆÙ‚ÙØª)
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø£ÙŠØ§Ù… Ù…Ù‚Ø±ÙˆØ¡Ø©ØŒ Ù†Ø¬Ù…Ø¹ Ø§Ù„ØµÙØ­Ø§Øª Ø­ØªÙ‰ Ø¢Ø®Ø± ÙŠÙˆÙ…
                if (readDays.length > 0) {
                    lastReadPage = totalPagesRead;
                }
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ù„Ù„ÙŠÙˆÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ù†Ù‚Ø¶ÙŠØ©
                const startDate = new Date(plan.startDate);
                const today = getLocalToday();
                const daysSinceStart = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
                const currentDayIndex = Math.max(0, Math.min(daysSinceStart, plan.totalDays - 1));
                
                // Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…ÙØªØ±Ø¶Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø·Ø© (Ø¨Ø¯ÙˆÙ† Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„ØªÙ‚Ø¯Ù…)
                const expectedPage = (currentDayIndex + 1) * plan.pagesPerDay;
                
                // Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‡ÙŠ Ø¢Ø®Ø± ØµÙØ­Ø© ØªÙ…Øª Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ + 1 (Ø£Ùˆ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø§Ù„Ø®Ø·Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ø¹Ø¯)
                const currentPage = lastReadPage + 1;
                
                const percentage = Math.min(100, Math.round((totalPagesRead / plan.totalPages) * 100));
                const remaining = Math.max(0, plan.totalPages - totalPagesRead);
                const surplus = totalPagesRead > plan.totalPages ? totalPagesRead - plan.totalPages : 0;
                const completed = totalPagesRead >= plan.totalPages;
                
                return {
                    pagesRead: totalPagesRead,
                    percentage,
                    remaining,
                    surplus,
                    completed,
                    daysRead,
                    maxPages,
                    bestDay,
                    currentPage: completed ? plan.totalPages : currentPage, // Ø¥Ø°Ø§ Ø§ÙƒØªÙ…Ù„ØŒ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‡ÙŠ Ø¢Ø®Ø± ØµÙØ­Ø©
                    expectedPage: completed ? plan.totalPages : expectedPage
                };
            }
            // --- Ø§Ø®ØªÙŠØ§Ø± Ø®Ø·Ø© ---
            window.selectPlan = function(planId) {
                currentPlanId = planId;
                localStorage.setItem('currentPlanId_v4', currentPlanId);
                renderPlans();
                renderPlanDetails(planId);
            };

            // --- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø© ---
            function renderPlanDetails(planId) {
                const plan = quranPlans.find(p => p.id === planId);
                if (!plan) return;

                planDetailContainer.style.display = 'block';
                
                const stats = calculatePlanStats(plan);
                const startDate = new Date(plan.startDate);
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø© Ø­ØªÙ‰ Ø§Ù„ÙŠÙˆÙ…
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const daysSinceStart = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
                const availableDays = Math.min(daysSinceStart + 1, plan.totalDays);
                
                let html = `
                    <div class="plan-detail-section">
                        <div class="plan-detail-header">
                            <h2><i class="fas fa-info-circle"></i> ${plan.name}</h2>
                            <button class="plan-action-btn edit" onclick="openEditPlanModal('${plan.id}', event)" style="opacity:1; position:static;">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                        
                                               <div class="plan-info">
                            <div class="info-card">
                                <div class="info-label">${translations[currentLang].dailyTarget}</div>
                                <div class="info-value">${plan.pagesPerDay}</div>
                            </div>
                            <!-- ÙƒØ§Ø±Ø¯ Ø¬Ø¯ÙŠØ¯ Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© -->
                            <div class="info-card">
                                <div class="info-label">${currentLang === 'ar' ? 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©' : 'Current Page'}</div>
                                <div class="info-value">${stats.currentPage}</div>
                            </div>
                            <!-- Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙƒØ§Ø±Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                            <div class="info-card">
                                <div class="info-label">${translations[currentLang].pagesRead}</div>
                                <div class="info-value">${stats.pagesRead}</div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">${translations[currentLang].remaining}</div>
                                <div class="info-value">${stats.remaining}</div>
                            </div>
                            ${stats.surplus > 0 ? `
                                <div class="info-card">
                                    <div class="info-label">${translations[currentLang].surplus}</div>
                                    <div class="info-value surplus">+${stats.surplus}</div>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="pages-progress">
                            <div class="pages-stats">
                                <span>${stats.pagesRead} / ${plan.totalPages} ${currentLang === 'ar' ? 'ØµÙØ­Ø©' : 'pages'}</span>
                                <span>${stats.percentage}%</span>
                            </div>
                            <div class="pages-bar">
                                <div class="pages-fill" style="width: ${stats.percentage}%"></div>
                            </div>
                        </div>
                    </div>
                `;

                // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
                html += `
                    <div class="reading-section">
                        <div class="reading-header">
                            <h2><i class="fas fa-calendar-alt"></i> ${translations[currentLang].days}</h2>
                            <div class="day-selector" id="day-selector">
                                <button class="day-nav-btn" id="prev-day" onclick="changeReadingDay(-1)">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                                <span class="current-day" id="current-day-display"></span>
                                <button class="day-nav-btn" id="next-day" onclick="changeReadingDay(1)">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="reading-card" id="reading-card">
                            <div class="quran-icon">
                                <i class="fas fa-quran"></i>
                            </div>
                            <div class="day-target">
                                <span class="target-number" id="target-pages">${plan.pagesPerDay}</span>
                                <span>${currentLang === 'ar' ? 'ØµÙØ­Ø©' : 'pages'}</span>
                            </div>
                            
                            <div class="reading-status">
                                <button class="status-btn" id="read-btn" onclick="setReadingStatus(true)">
                                    <i class="fas fa-check-circle"></i> ${translations[currentLang].read}
                                </button>
                                <button class="status-btn" id="not-read-btn" onclick="setReadingStatus(false)">
                                    <i class="fas fa-times-circle"></i> ${translations[currentLang].notRead}
                                </button>
                            </div>
                            
                            <div class="pages-input">
                                <label for="pages-read-input">${translations[currentLang].pagesRead}:</label>
                                <input type="number" id="pages-read-input" min="0" step="1" value="${plan.pagesPerDay}">
                            </div>
                            
                            <button class="save-reading-btn" id="save-reading-btn" onclick="saveReading('${planId}')">
                                <i class="fas fa-save"></i> ${translations[currentLang].save}
                            </button>
                        </div>
                    </div>
                `;

                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ©
               // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ø¹ Ø£ÙØ¶Ù„ ÙŠÙˆÙ… Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ®
// Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø¯Ø§Ø®Ù„ renderPlanDetails ÙˆØ­Ø¯Ø«Ù‡
let bestDayDisplay = '-';
if (stats.bestDay) {
    const bestDate = new Date(stats.bestDay);
    const formattedBestDate = formatDate(bestDate);
    // Ø¬Ø¹Ù„ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø³Ø·Ø± ÙˆØ§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ Ø³Ø·Ø± Ø£Ùˆ ØªÙ†Ø³ÙŠÙ‚Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„
    bestDayDisplay = `<div style="font-size: 0.9rem">${formattedBestDate}</div> <div style="color: var(--accent-color)">${stats.maxPages} ${currentLang === 'ar' ? 'ØµÙØ­Ø©' : 'pages'}</div>`;
}

html += `
    <div class="plan-stats-section">
        <h2><i class="fas fa-chart-pie"></i> ${translations[currentLang].completionRate}</h2>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value">${stats.daysRead}</div>
                <div class="stat-label">${translations[currentLang].daysCompleted}</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">${Math.max(0, availableDays - stats.daysRead)}</div>
                <div class="stat-label">${translations[currentLang].daysMissed}</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">${stats.daysRead > 0 ? Math.round(stats.pagesRead / stats.daysRead) : 0}</div>
                <div class="stat-label">${translations[currentLang].average}</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" style="font-size: 1.4rem;" title="${stats.bestDay ? new Date(stats.bestDay).toLocaleDateString(currentLang === 'ar' ? 'ar-EG' : 'en-US') : ''}">
                    ${bestDayDisplay}
                </div>
                <div class="stat-label">
                    <i class="fas fa-crown" style="color: var(--accent-color);"></i> 
                    ${translations[currentLang].bestDay}
                </div>
            </div>
        </div>
    </div>
`;

                planDetailContainer.innerHTML = html;

                // Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
                window.currentPlanForReading = plan;
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ÙŠÙˆÙ… Ù…Ø­ÙÙˆØ¸ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ Ø§Ø³ØªØ®Ø¯Ù…Ù‡ØŒ ÙˆØ¥Ù„Ø§ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
                if (!window.currentReadingDayIndex) {
                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
                   const today = getLocalToday();

                    const startDate = new Date(plan.startDate);
                    const diffTime = today - startDate;
                    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays >= 0 && diffDays < plan.totalDays) {
                        window.currentReadingDayIndex = diffDays;
                    } else if (diffDays < 0) {
                        window.currentReadingDayIndex = 0;
                    } else {
                        window.currentReadingDayIndex = plan.totalDays - 1;
                    }
                }
                
                updateReadingDayDisplay(plan);
            }

            // --- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ---
            window.currentPlanForReading = null;
            window.currentReadingDayIndex = 0;

            // --- ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ… ---
            function updateReadingDayDisplay(plan) {
                const startDate = new Date(plan.startDate);
                const currentDate = new Date(startDate);
                currentDate.setDate(currentDate.getDate() + window.currentReadingDayIndex);
                
                const isFuture = currentDate > today;
                const dayKey = formatDateKey(currentDate);
                const dayData = plan.progress[dayKey] || { read: false, pages: 0 };
                
                document.getElementById('current-day-display').textContent = formatDate(currentDate);
                document.getElementById('target-pages').textContent = plan.pagesPerDay;
                document.getElementById('pages-read-input').value = dayData.pages > 0 ? dayData.pages : plan.pagesPerDay;
                
                const readingCard = document.getElementById('reading-card');
                const readBtn = document.getElementById('read-btn');
                const notReadBtn = document.getElementById('not-read-btn');
                const saveBtn = document.getElementById('save-reading-btn');
                
                if (isFuture) {
                    readingCard.style.opacity = '0.5';
                    readingCard.style.pointerEvents = 'none';
                    readBtn.disabled = true;
                    notReadBtn.disabled = true;
                    saveBtn.disabled = true;
                } else {
                    readingCard.style.opacity = '1';
                    readingCard.style.pointerEvents = 'all';
                    readBtn.disabled = false;
                    notReadBtn.disabled = false;
                    saveBtn.disabled = false;
                    
                    if (dayData.read) {
                        readingCard.classList.add('completed');
                        readBtn.classList.add('read');
                        notReadBtn.classList.remove('read');
                    } else {
                        readingCard.classList.remove('completed');
                        notReadBtn.classList.add('read');
                        readBtn.classList.remove('read');
                    }
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„
                document.getElementById('prev-day').disabled = window.currentReadingDayIndex === 0;
                document.getElementById('next-day').disabled = window.currentReadingDayIndex >= plan.totalDays - 1;
            }

            // --- ØªØºÙŠÙŠØ± ÙŠÙˆÙ… Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ---
            window.changeReadingDay = function(delta) {
                const plan = window.currentPlanForReading;
                if (!plan) return;
                
                const newIndex = window.currentReadingDayIndex + delta;
                if (newIndex >= 0 && newIndex < plan.totalDays) {
                    window.currentReadingDayIndex = newIndex;
                    updateReadingDayDisplay(plan);
                }
            };

            // --- ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ---
            window.setReadingStatus = function(read) {
                const plan = window.currentPlanForReading;
                if (!plan) return;
                
                const startDate = new Date(plan.startDate);
                const currentDate = new Date(startDate);
                currentDate.setDate(currentDate.getDate() + window.currentReadingDayIndex);
                
                if (currentDate > today) return;
                
                const readBtn = document.getElementById('read-btn');
                const notReadBtn = document.getElementById('not-read-btn');
                const readingCard = document.getElementById('reading-card');
                
                if (read) {
                    readingCard.classList.add('completed');
                    readBtn.classList.add('read');
                    notReadBtn.classList.remove('read');
                } else {
                    readingCard.classList.remove('completed');
                    notReadBtn.classList.add('read');
                    readBtn.classList.remove('read');
                }
            };

            // --- Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ---
            window.saveReading = function(planId) {
                const plan = quranPlans.find(p => p.id === planId);
                if (!plan) return;
                
                const startDate = new Date(plan.startDate);
                const currentDate = new Date(startDate);
                currentDate.setDate(currentDate.getDate() + window.currentReadingDayIndex);
                
                if (currentDate > today) return;
                
                const dayKey = formatDateKey(currentDate);
                const pagesRead = parseInt(document.getElementById('pages-read-input').value) || 0;
                const read = document.getElementById('reading-card').classList.contains('completed');
                
                plan.progress[dayKey] = {
                    read: read,
                    pages: read ? pagesRead : 0,
                    date: dayKey
                };
                
                localStorage.setItem('quranPlans_v4', JSON.stringify(quranPlans));
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ…
                renderPlans();
                renderPlanDetails(planId);
                showNotification(translations[currentLang].saved);
            };

            // --- Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ---
          function formatDate(date) {
    const dayOfMonth = date.getDate();
    const monthName = months[currentLang][date.getMonth()];
    
    // Ø¬Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„ÙŠÙˆÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (0-6)
    const dayName = daysOfWeek[currentLang][date.getDay()];
    
    // Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù†Øµ Ø¨Ø§Ù„Ø´ÙƒÙ„: Ø§Ù„Ø³Ø¨ØªØŒ 11 ÙØ¨Ø±Ø§ÙŠØ±
    return currentLang === 'ar' 
        ? `${dayName}ØŒ ${dayOfMonth} ${monthName}` 
        : `${dayName}, ${monthName} ${dayOfMonth}`;
}
            
           function formatDateKey(date) {
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø­Ù„ÙŠ ÙˆÙ„ÙŠØ³ UTC
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}


            const months = {
                ar: ["ÙŠÙ†Ø§ÙŠØ±", "ÙØ¨Ø±Ø§ÙŠØ±", "Ù…Ø§Ø±Ø³", "Ø£Ø¨Ø±ÙŠÙ„", "Ù…Ø§ÙŠÙˆ", "ÙŠÙˆÙ†ÙŠÙˆ", "ÙŠÙˆÙ„ÙŠÙˆ", "Ø£ØºØ³Ø·Ø³", "Ø³Ø¨ØªÙ…Ø¨Ø±", "Ø£ÙƒØªÙˆØ¨Ø±", "Ù†ÙˆÙÙ…Ø¨Ø±", "Ø¯ÙŠØ³Ù…Ø¨Ø±"],
                en: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
            };

            const daysOfWeek = {
    ar: ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ø³Ø¨Øª"],
    en: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]
};

            // --- Ø§Ù„ØªÙ…Ø±ÙŠØ± ---
            function handleScroll() {
                backToTopBtn.classList.toggle('show', window.scrollY > 300);
            }
            
            function scrollToTop() { 
                window.scrollTo({ top: 0, behavior: 'smooth' }); 
            }

            // --- Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ---
            function init() {
                setupTheme();
                
                themeSwitcher.addEventListener('click', toggleTheme);
                langSwitcher.addEventListener('click', toggleLanguage);
                window.addEventListener('scroll', handleScroll);
                backToTopBtn.addEventListener('click', scrollToTop);

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„ØºØ© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
                document.documentElement.lang = currentLang;
                document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
                document.getElementById('lang-toggle').textContent = currentLang === 'ar' ? 'EN' : 'Ø¹Ø±Ø¨ÙŠ';
                
                // ØªØ±Ø¬Ù…Ø© Ø£ÙˆÙ„ÙŠØ©
                document.querySelectorAll('[data-key]').forEach(el => {
                    const key = el.getAttribute('data-key');
                    if (translations[currentLang][key]) {
                        el.textContent = translations[currentLang][key];
                    }
                });
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø·Ø·
                renderPlans();
                
                // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¥Ù† ÙˆØ¬Ø¯Øª
                if (currentPlanId) {
                    renderPlanDetails(currentPlanId);
                }
            }

            init();
        })();
    </script>
</body>
</html>